<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bayesian Statistics</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h2 id="chapter-5---bayesian-statistics">Chapter 5 - Bayesian Statistics</h2>
<h4 id="bayesian-model-selection">Bayesian Model selection</h4>
<ul>
<li>
<p>If there are <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">M</mi></mrow><annotation encoding="application/x-tex">\mathcal{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">M</span></span></span></span></span></span> models how do we pick the model that is the best? One approach would be to compute the posterior over the models:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>m</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">D</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi>m</mi><mo>)</mo></mrow><mrow><munder><mo>∑</mo><mrow><mi>m</mi><mo>∈</mo><mi mathvariant="script">M</mi></mrow></munder><mi>p</mi><mo>(</mo><mi>m</mi><mo separator="true">,</mo><mi mathvariant="script">D</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">p(m | \mathcal{D})=\frac{p(\mathcal{D} | m) p(m)}{\sum_{m \in \mathcal{M}} p(m, \mathcal{D})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 2.44008em; vertical-align: -1.01308em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.17862099999999992em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708000000000004em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.01308em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
</li>
<li>
<p>From this, we can easily compute the MAP model, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>m</mi><mo>^</mo></mover><mo>=</mo><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi>p</mi><mo>(</mo><mi>m</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">D</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat{m}=\operatorname{argmax} p(m | \mathcal{D})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">m</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">)</span></span></span></span></span>. This is called <strong>Bayesian model selection</strong>.</p>
</li>
<li>
<p>If we use a uniform prior over models, this amounts to picking the model which maximizes</p>
</li>
</ul>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>)</mo><mo>=</mo><mo>∫</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>)</mo><mi>d</mi><mi mathvariant="bold-italic">θ</mi></mrow><annotation encoding="application/x-tex">p(\mathcal{D} | m)=\int p(\mathcal{D} | \boldsymbol{\theta}) p(\boldsymbol{\theta} | m) d \boldsymbol{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 2.22225em; vertical-align: -0.86225em;"></span><span class="mop op-symbol large-op" style="margin-right: 0.44445em; position: relative; top: -0.0011249999999999316em;">∫</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span></span></span></span></p>
<ul>
<li>
<p>This quantity is called the <strong>marginal likelihood</strong>, the integrated likelihood, or the <strong>evidence</strong> for model <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>.</p>
</li>
<li>
<p>One might think that using p(D|m) to select models would always favor the model with the most parameters.</p>
</li>
<li>
<p>This is true if we use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mrow><mo fence="true">(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><msub><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mi>m</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p\left(\mathcal{D} | \hat{\boldsymbol{\theta}}_{m}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.80002em; vertical-align: -0.65002em;"></span><span class="mord mathit">p</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span> to select models, where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\theta}}_{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.1078799999999998em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is the MLE or MAP estimate of the parameters for model <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>, because models with more parameters will fit the data better, and hence achieve higher likelihood.</p>
</li>
<li>
<p>However, if we integrate out the parameters, we are automatically protected from overfitting: <strong>models with more parameters do not necessarily have higher marginal likelihood</strong>.</p>
</li>
<li>
<p>This is called the <strong>Bayesian Occam’s razor effect</strong>, named after the principle known as Occam’s razor, which says one should pick the simplest model that adequately explains the data.</p>
</li>
<li>
<p>Next, we look at ways to compute the marginal likelihood (i.e., the evidence) for a fixed/given model (our task is parameter selection <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold-italic">θ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span></span></span>):</p>
</li>
</ul>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">D</mi><mo separator="true">,</mo><mi>m</mi><mo>)</mo><mo>=</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo separator="true">,</mo><mi>m</mi><mo>)</mo><mi mathvariant="normal">/</mi><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\boldsymbol{\theta} | \mathcal{D}, m) = p(\boldsymbol{\theta} | m) p(\mathcal{D} | \boldsymbol{\theta}, m)/p(\mathcal{D}|m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord mathit">m</span><span class="mclose">)</span></span></span></span></span> <a href="https://math.stackexchange.com/questions/1281454/bayes-rule-with-3-variables">Refer Bayes’ rule with 3 variables</a></p>
<p>We can ignore the denominator since it is a constant with respect to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold-italic">θ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span></span></span>.</p>
<ul>
<li>However, when comparing different models, we need to compute the denominator <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathcal{D}|m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord mathit">m</span><span class="mclose">)</span></span></span></span></span>.</li>
<li>In general, this can be quite hard, since we have to integrate over all possible parameter values, but when we have a conjugate prior, it is easy to compute (Eg. binomial likelihood and Beta prior, multinoulli/categorical likelihood and Dirichlet prior).</li>
<li>One simple but popular approximation (to model selection using mariginal likelihood) is known as the <strong>Bayesian information criterion or BIC</strong>:</li>
</ul>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">B</mi><mi mathvariant="normal">I</mi><mi mathvariant="normal">C</mi></mrow><mo>≜</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mo>)</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">dof</mi><mo>⁡</mo><mo>(</mo><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mo>)</mo></mrow><mn>2</mn></mfrac><mi>log</mi><mo>⁡</mo><mi>N</mi><mo>≈</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathrm{BIC} \triangleq \log p(\mathcal{D} | \hat{\boldsymbol{\theta}})-\frac{\operatorname{dof}(\hat{\boldsymbol{\theta}})}{2} \log N \approx \log p(\mathcal{D})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.99865em; vertical-align: -0.08198em;"></span><span class="mord"><span class="mord mathrm">B</span><span class="mord mathrm">I</span><span class="mord mathrm">C</span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel amsrm">≜</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.2078799999999998em; vertical-align: -0.25em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 2.32088em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6348799999999999em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">d</span><span class="mord mathrm">o</span><span class="mord mathrm" style="margin-right: 0.07778em;">f</span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p>where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">dof</mi><mo>⁡</mo><mo>(</mo><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mo>)</mo></mrow><annotation encoding="application/x-tex">\operatorname{dof}(\hat{\boldsymbol{\theta}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.2078799999999998em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">d</span><span class="mord mathrm">o</span><span class="mord mathrm" style="margin-right: 0.07778em;">f</span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> is the number of degrees of freedom in the model (the number of parameters), <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">N</span></span></span></span></span> is the number of datapoints and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\theta}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.9578799999999998em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span></span></span></span></span> is the MLE for the model.</p>
<ul>
<li>
<p>We see that this has the form of a <strong>penalized log likelihood</strong>, where the penalty term depends on the model’s complexity.</p>
</li>
<li>
<p>The BIC method is very closely related to the <strong>minimum description length</strong> or MDL principle, which characterizes the score for a model in terms of how well it fits the data, minus how complex the model is to define.</p>
</li>
<li>
<p>There is a very similar expression to BIC/ MDL called the Akaike information criterion or AIC<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">AIC</mi><mo>⁡</mo><mo>(</mo><mi>m</mi><mo separator="true">,</mo><mi mathvariant="script">D</mi><mo>)</mo><mo>≜</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mrow><mo fence="true">(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><msub><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>−</mo><mi mathvariant="normal">dof</mi><mo>⁡</mo><mo>(</mo><mi>m</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\operatorname{AIC}(m, \mathcal{D}) \triangleq \log p\left(\mathcal{D} | \hat{\boldsymbol{\theta}}_{M L E}\right)-\operatorname{dof}(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.1666699999999999em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">A</span><span class="mord mathrm">I</span><span class="mord mathrm">C</span></span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel amsrm">≜</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.80002em; vertical-align: -0.65002em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32833099999999993em;"><span class="" style="top: -2.5500000000000003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right: 0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">d</span><span class="mord mathrm">o</span><span class="mord mathrm" style="margin-right: 0.07778em;">f</span></span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mclose">)</span></span></span></span></span></span></p>
</li>
<li>
<p>AIC is derived from a frequentist framework, and cannot be interpreted as an approximation to the marginal likelihood. Nevertheless, the form of this expression is very similar to BIC. We see that the penalty for AIC is less than for BIC. This causes AIC to pick more complex models. However, this can result in better predictive accuracy.</p>
</li>
<li>
<p>For posterior inference, we are required to decide on a prior. If the prior is unknown, the correct Bayesian procedure is to put a prior on the prior! For example, if the weights have a prior <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">w</mi><mo>)</mo><mo>=</mo><mi mathvariant="script">N</mi><mrow><mo fence="true">(</mo><mn mathvariant="bold">0</mn><mo separator="true">,</mo><msup><mi>α</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="bold">I</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\mathbf{w})=\mathcal{N}\left(\mathbf{0}, \alpha^{-1} \mathbf{I}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">w</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.20001em; vertical-align: -0.35001em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.14736em;">N</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">0</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141079999999999em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span> is a hyperparameter. The strength of the prior is based on <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span>. (if we are unsure of what <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span> should be, we specify a hyperprior, i.e., a prior over the hyperparameter)</p>
</li>
<li>
<p>This is an example of a <strong>hierarchical Bayesian model</strong>, also called a multi-level model, since there are multiple levels of unknown quantities. Using graphical model notation, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold-italic">α</mi><mo>→</mo><mi mathvariant="bold">w</mi><mo>→</mo><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\alpha} \rightarrow \mathbf{w} \rightarrow \mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.44444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">α</span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.44444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">w</span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span></span></span></span></span></p>
</li>
<li>
<p>Fortunately, the higher up we go in the Bayesian hierarchy, the less sensitive are the results to the prior settings. So we can usually make the hyper-prior uninformative.</p>
</li>
</ul>
<h4 id="uninformative-priors">Uninformative priors</h4>
<ul>
<li>One criticism of Bayesian methods is the reliance of priors.</li>
<li>If we don’t have strong beliefs about what <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span> should be, it is common to use an <strong>uninformative</strong> or non-informative prior, and to “let the data speak for itself”.</li>
<li>Choosing uninformative priors is somewhat tricky! For example, consider the Bernoulli parameter <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mo>∈</mo><mo>[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">\theta \in[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.0391em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>. The conjugate prior that comes to our mind is uniform distribution, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">B</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathrm{Beta}(1,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">B</span><span class="mord mathrm">e</span><span class="mord mathrm">t</span><span class="mord mathrm">a</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>.</li>
<li>But the posterior mean in this case is <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="double-struck">E</mi><mo>[</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">D</mi><mo>]</mo><mo>=</mo><mfrac><mrow><msub><mi>N</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn></mrow><mrow><msub><mi>N</mi><mn>1</mn></msub><mo>+</mo><msub><mi>N</mi><mn>0</mn></msub><mo>+</mo><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathbb{E}[\theta | \mathcal{D}]=\frac{N_{1}+1}{N_{1}+N_{0}+2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.3335309999999998em; vertical-align: -0.44509999999999994em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8884309999999999em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.31731428571428577em;"><span class="" style="top: -2.357em; margin-left: -0.10903em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.31731428571428577em;"><span class="" style="top: -2.357em; margin-left: -0.10903em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.4101em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.31731428571428577em;"><span class="" style="top: -2.357em; margin-left: -0.10903em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.44509999999999994em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>, whereas the MLE is <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mi>N</mi><mn>1</mn></msub><mrow><msub><mi>N</mi><mn>1</mn></msub><mo>+</mo><msub><mi>N</mi><mn>0</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{N_{1}}{N_{1}+N_{0}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.3335309999999998em; vertical-align: -0.44509999999999994em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8884309999999999em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.31731428571428577em;"><span class="" style="top: -2.357em; margin-left: -0.10903em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.31731428571428577em;"><span class="" style="top: -2.357em; margin-left: -0.10903em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.4101em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.31731428571428577em;"><span class="" style="top: -2.357em; margin-left: -0.10903em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.44509999999999994em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>. Hence one could argue that the prior wasn’t completely uninformative after all (since the posterior numerator and denominator was affected by the beta parameters (1,1)).</li>
<li>By the above argument, the most non-informative prior is <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>lim</mi><mo>⁡</mo><mrow><mi>c</mi><mo>→</mo><mn>0</mn></mrow></msub><mi mathvariant="normal">Bet</mi><mo>⁡</mo><mi>a</mi><mo>(</mo><mi>c</mi><mo separator="true">,</mo><mi>c</mi><mo>)</mo><mo>=</mo><mi mathvariant="normal">Beta</mi><mo>⁡</mo><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">\lim _{c \rightarrow 0} \operatorname{Bet} a(c, c)=\operatorname{Beta}(0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">lim</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.30110799999999993em;"><span class="" style="top: -2.5500000000000003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mrel mtight">→</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop"><span class="mord mathrm">B</span><span class="mord mathrm">e</span><span class="mord mathrm">t</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">a</span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">B</span><span class="mord mathrm">e</span><span class="mord mathrm">t</span><span class="mord mathrm">a</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></li>
<li>However, this does not work well and the suggested non-informative prior is <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Beta</mi><mo>⁡</mo><mo>(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">\operatorname{Beta}(1/2,1/2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">B</span><span class="mord mathrm">e</span><span class="mord mathrm">t</span><span class="mord mathrm">a</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></li>
</ul>
<hr>
<h3 id="empirical-bayes">Empirical Bayes</h3>
<p>In hierarchical Bayesian models, we need to compute the posterior on multiple levels of latent variables.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">η</mi><mo separator="true">,</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">D</mi><mo>)</mo><mo>∝</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">η</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\boldsymbol{\eta}, \boldsymbol{\theta} | \mathcal{D}) \propto p(\mathcal{D} | \boldsymbol{\theta}) p(\boldsymbol{\theta} | \boldsymbol{\eta}) p(\boldsymbol{\eta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p>Graphical model: <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold-italic">η</mi><mo>→</mo><mi>θ</mi><mo>→</mo><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\eta} \rightarrow \mathbf{\theta} \rightarrow \mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold-italic">η</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\eta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span></span></span></span></span> refers to the model hyperparameters (usually much smaller dimension than the actual parameter space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span>). As a computational shortcut, we can use a point estimate for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold-italic">η</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\eta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span></span></span></span></span>.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">η</mi><mo>^</mo></mover><mo>=</mo><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">η</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">D</mi><mo>)</mo><mo>=</mo><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo><mo>=</mo><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mrow><mo fence="true">[</mo><mo>∫</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo><mi>d</mi><mi mathvariant="bold-italic">θ</mi><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\eta}}=\operatorname{argmax} p(\boldsymbol{\eta}|\mathcal{D})=\operatorname{argmax} p(\mathcal{D} | \boldsymbol{\eta})=\operatorname{argmax}\left[\int p(\mathcal{D} | \boldsymbol{\theta}) p(\boldsymbol{\theta} | \boldsymbol{\eta}) d \boldsymbol{\theta}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.90232em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 2.40003em; vertical-align: -0.95003em;"></span><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mop op-symbol large-op" style="margin-right: 0.44445em; position: relative; top: -0.0011249999999999316em;">∫</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></span><br>
(Assuming uniform prior on <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold-italic">η</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\eta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span></span></span></span></span>)</p>
<ul>
<li>This overall approach is called empirical Bayes (EB)or type-II maximum likelihood. In machine learning, it is sometimes called the evidence procedure.</li>
<li>Empirical Bayes violates the principle that the prior should be chosen independently of the data! (since in the above we use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span></span></span></span></span> to compute <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">η</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\eta}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.90232em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span>)</li>
</ul>
<hr>
<p><strong>Summary of parameter estimation methods</strong>:</p>
<ul>
<li>
<p>Maximum likelihood :  <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mo>=</mo><msub><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi mathvariant="bold-italic">θ</mi></msub><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\theta}}=\operatorname{argmax}_{\boldsymbol{\theta}} p(\mathcal{D} | \boldsymbol{\theta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.9578799999999998em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.24196799999999993em;"><span class="" style="top: -2.4558600000000004em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>MAP: <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mo>=</mo><msub><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi mathvariant="bold-italic">θ</mi></msub><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\theta}}=\operatorname{argmax}_{\boldsymbol{\theta}} p(\mathcal{D} | \boldsymbol{\theta}) p(\boldsymbol{\theta} | \boldsymbol{\eta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.9578799999999998em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9578799999999998em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.24196799999999993em;"><span class="" style="top: -2.4558600000000004em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>ML-II (Empirical Bayes):  <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">η</mi><mo>^</mo></mover><mo>=</mo><msub><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi mathvariant="bold-italic">η</mi></msub><mo>∫</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo><mi>d</mi><mi mathvariant="bold-italic">θ</mi><mo>=</mo><msub><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi mathvariant="bold-italic">η</mi></msub><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\eta}}=\operatorname{argmax}_{\boldsymbol{\eta}} \int p(\mathcal{D} | \boldsymbol{\theta}) p(\boldsymbol{\theta} | \boldsymbol{\eta}) d \boldsymbol{\theta}=\operatorname{argmax}_{\boldsymbol{\eta}} p(\mathcal{D} | \boldsymbol{\eta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.90232em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.185248em; vertical-align: -0.380248em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.06696799999999997em;"><span class="" style="top: -2.4558600000000004em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.03704em;">η</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.380248em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="margin-right: 0.19445em; position: relative; top: -0.0005599999999999772em;">∫</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.130248em; vertical-align: -0.380248em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.06696799999999997em;"><span class="" style="top: -2.4558600000000004em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.03704em;">η</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.380248em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>MAP-II : <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">η</mi><mo>^</mo></mover><mo>=</mo><msub><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi mathvariant="bold-italic">η</mi></msub><mo>∫</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">η</mi><mo>)</mo><mi>d</mi><mi mathvariant="bold-italic">θ</mi><mo>=</mo><msub><mi mathvariant="normal">argmax</mi><mo>⁡</mo><mi>η</mi></msub><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">η</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">{\hat{\boldsymbol{\eta}}=\operatorname{argmax}_{\boldsymbol{\eta}} \int p(\mathcal{D} | \boldsymbol{\theta}) p(\boldsymbol{\theta} | \boldsymbol{\eta}) p(\boldsymbol{\eta}) d \boldsymbol{\theta}=\operatorname{argmax}_{\eta} p(\mathcal{D} | \boldsymbol{\eta}) p(\boldsymbol{\eta})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185248em; vertical-align: -0.380248em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.06696799999999997em;"><span class="" style="top: -2.4558600000000004em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.03704em;">η</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.380248em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="margin-right: 0.19445em; position: relative; top: -0.0005599999999999772em;">∫</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.057252000000000025em;"><span class="" style="top: -2.4558600000000004em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">η</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.380248em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span></span></span></span></span></span> (prior of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold-italic">η</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\eta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span></span></span></span></span> is not assumed to be uniform)</p>
</li>
<li>
<p>Full Bayes: <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mo separator="true">,</mo><mi mathvariant="bold-italic">η</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">D</mi><mo>)</mo><mo>∝</mo><mi>p</mi><mo>(</mo><mi mathvariant="script">D</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">θ</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold-italic">η</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi mathvariant="bold-italic">η</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\boldsymbol{\theta}, \boldsymbol{\eta} | \mathcal{D}) \propto p(\mathcal{D} | \boldsymbol{\theta}) p(\boldsymbol{\theta} | \boldsymbol{\eta}) p(\boldsymbol{\eta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">η</span></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
</ul>
<hr>
<h3 id="bayesian-decision-theory">Bayesian decision theory</h3>
<ul>
<li>
<p>We can formalize any given statistical decision problem as a game against nature.</p>
</li>
<li>
<p>Nature picks a state or parameter or label, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>∈</mo><mi mathvariant="script">Y</mi></mrow><annotation encoding="application/x-tex">y \in \mathcal{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7335400000000001em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.78055em; vertical-align: -0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.08222em;">Y</span></span></span></span></span></span>, unknown to us, and then generates an observation, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>∈</mo><mi mathvariant="script">Y</mi></mrow><annotation encoding="application/x-tex">y \in \mathcal{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7335400000000001em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.78055em; vertical-align: -0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.08222em;">Y</span></span></span></span></span></span>, which we get to see.</p>
</li>
<li>
<p>We then have to make a decision, i.e., we have to choose an action <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">a</span></span></span></span></span> from some action space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">A</span></span></span></span></span></span>.</p>
</li>
<li>
<p>Finally we incur some loss, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">L(y, a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></span>, which measures how compatible our action a is with nature’s hidden state y. For example, we might use misclassification loss, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi mathvariant="double-struck">I</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">≠</mi><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">L(y, a)=\mathbb{I}(y \neq a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbb">I</span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.8888799999999999em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel latin_fallback"≯</span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></span>, or squared loss, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mo>(</mo><mi>y</mi><mo>−</mo><mi>a</mi><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L(y, a)=(y - a)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1.064108em; vertical-align: -0.25em;"></span><span class="mord mathit">a</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141079999999999em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>.</p>
</li>
<li>
<p>Our goal is to devise a <strong>decision procedure</strong> or <strong>policy</strong>, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>:</mo><mi mathvariant="script">X</mi><mo>→</mo><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\delta : \mathcal{X} \rightarrow \mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03785em;">δ</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.14643em;">X</span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">A</span></span></span></span></span></span>, which specifies the optimal action for each possible input. For example, one that minimizes the loss:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo><mo>=</mo><munder><mo><mi mathvariant="normal">argmin</mi><mo>⁡</mo></mo><mrow><mi>a</mi><mo>∈</mo><mi mathvariant="script">A</mi></mrow></munder><mi mathvariant="double-struck">E</mi><mo>[</mo><mi>L</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\delta(\mathbf{x})=\underset{a \in \mathcal{A}}{\operatorname{argmin}} \mathbb{E}[L(y, a)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.716141em; vertical-align: -0.966141em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.161229em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight">A</span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right: 0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.966141em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">[</span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></span></p>
</li>
<li>
<p>In the <strong>Bayesian approach to decision theory</strong>, the optimal action, having observed <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.44444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span></span>, is defined as the action <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">a</span></span></span></span></span> that minimizes the <strong>posterior expected loss</strong>:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><mo>(</mo><mi>a</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold">x</mi><mo>)</mo><mo>≜</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>p</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow></msub><mo>[</mo><mi>L</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>]</mo><mo>=</mo><munder><mo>∑</mo><mi>y</mi></munder><mi>L</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\rho(a | \mathbf{x}) \triangleq \mathbb{E}_{p(y | \mathbf{x})}[L(y, a)]=\sum_{y} L(y, a) p(y | \mathbf{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.1666699999999999em; vertical-align: -0.25em;"></span><span class="mord mathit">ρ</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel amsrm">≜</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.1052em; vertical-align: -0.3551999999999999em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.34480000000000005em;"><span class="" style="top: -2.5198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathbf mtight">x</span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3551999999999999em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 2.4361180000000004em; vertical-align: -1.386113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0500050000000003em;"><span class="" style="top: -1.8999949999999999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span><span class="" style="top: -3.050005em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.386113em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span></span></span></span></span></span></p>
</li>
<li>
<p>Hence the Bayes estimator, also called the <strong>Bayes decision rule</strong>, is given by<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mi>min</mi><mo>⁡</mo><mrow><mi>a</mi><mo>∈</mo><mi mathvariant="script">A</mi></mrow></munder><mi>ρ</mi><mo>(</mo><mi mathvariant="bold">a</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\delta(\mathbf{x})=\arg \min _{a \in \mathcal{A}} \rho(\mathbf{a} | \mathbf{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.521701em; vertical-align: -0.771701em;"></span><span class="mop">ar<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.055669em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight">A</span></span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.771701em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathit">ρ</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">a</span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span></span></span></span></span></span></p>
</li>
<li>
<p>In this section, we saw “one-shot decision problems”, i.e., the game ends after the decision is made - you either win or lose. In many scenarios, we continue to make new decisions as we get new information, this is called sequential decision theory - closely related to reinforcement learning.</p>
</li>
</ul>
<hr>
<h3 id="evaluation">Evaluation</h3>
<ul>
<li>Area under ROC curve [varying levels of probability threshold gives different true positive rates (<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mi>P</mi><mi>R</mi><mo>=</mo><mi>T</mi><mi>P</mi><mi mathvariant="normal">/</mi><msub><mi>N</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">TPR=TP / N_{+}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mord">/</span><span class="mord"><span class="mord mathit" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.25833100000000003em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span> = Recall) and false positive rates (<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi>P</mi><mi>R</mi><mo>=</mo><mi>F</mi><mi>P</mi><mi mathvariant="normal">/</mi><msub><mi>N</mi><mo>−</mo></msub></mrow><annotation encoding="application/x-tex">FPR=FP / N_{-}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mord">/</span><span class="mord"><span class="mord mathit" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.25833100000000003em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>)]</li>
<li>Precision: measures what fraction of our detections are actually positive</li>
<li>Recall: measures what fraction of the positives we actually detected</li>
<li>Precision recall curve is different from ROC curve and is more relevant when evaluation information retrieval systems when the number of positives are small and the number of negatives <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>N</mi><mo>−</mo></msub></mrow><annotation encoding="application/x-tex">N_{-}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.891661em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.25833100000000003em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span> are very large (hence <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi>P</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">FPR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mord mathit" style="margin-right: 0.00773em;">R</span></span></span></span></span> does not make much sense). One can report <strong>precision at K</strong> (i.e., precision score after retriving K documents)</li>
<li>Precision recall curves give an idea about how precision and recall vary with different probability thresholds. However, to get a single value for a fixed threshold, one can use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mn>1</mn><mo>−</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">F1-score</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span></span></span></span></span>.</li>
<li>In the multi-class problem to compute P/R/F1, one can do either
<ul>
<li><strong>macro-averaging</strong>: for each class, treat it as one-vs-all classification and compute individual F1 and then average the values obtained from all classes.</li>
<li><strong>micro-averaging</strong>: create a single 2x2 confusion matrix by filling in the summed up TP, FP, TN, FN values from all classes and then compute a single F1 for this one CM.</li>
</ul>
</li>
</ul>
<hr>
</div>
</body>

</html>
